# **RAMP Demand Simulator â€“ Streamlit Application**
*A lightweight, interactive workflow for generating high-resolution load demand profiles using the RAMP framework.*

<p align="center">
  <img src="config/assets/ramp.png" width="500" alt="RAMP for Bottom-Up Load Demand Simulation">
</p>

The **RAMP Demand Simulator** is a fully interactive Streamlit application designed to simplify the entire workflow of preparing inputs, generating daily stochastic demand profiles, assembling a synthetic â€œfull year,â€ and visualizing the resulting minute-resolution curves.  
Instead of manually preparing multiple spreadsheets and calling Python scripts, this interface guides the user through a clean, intuitive, and reproducible process. With RAMPâ€™s stochastic engine under the hood and Streamlit providing an intuitive UI, the tool enables fully transparent and modular bottom-up load simulation at **one-minute resolution**.


---

## Features

### Flexible year structure
Users can configure the temporal structure of the year:
- 1â€“4 **seasons**, with custom month assignments
- Optional within-week differentiation (e.g. *Weekday vs Weekend* or custom week-classes)
- Each combination *(Season Ã— Week-class)* defines a **day archetype**

### Input building from simplified Excel
- Upload simplified RAMP inputs (one file per archetype or a single file for the whole year)
- The app expands each into a **full RAMP-compatible Excel**
- Archetype configurations are persisted on disk

### Two simulation modes

**Single-archetype mode**

A single input represents the entire year. RAMP generates `num_days` independent daily profiles; the app tiles/downsamples them to form a 365Ã—1440 matrix.

**Multi-archetype mode**

Each archetype defines a stochastic pool of `num_days` synthetic days. The final 365-day year is built by:
1. Walking through a calendar year
2. Mapping each calendar date to its season and (optional) week-class
3. Sampling one day from the corresponding archetype pool

This captures intra-archetype variability (stochastic appliance behaviour) and inter-archetype diversity (seasonal/week patterns).

### Visualization and inspection tools
- Aggregated and per-category profiles
- Daily clouds + minâ€“max envelopes
- Seasonal & weekly filters (if defined)
- Specific day inspection
- Hourly averages
- Automatic profile export for energy modelling

---

# **ğŸ“ Repository Structure**
```bash

project/
â”‚
â”œâ”€â”€ app.py # Main Streamlit application
â”œâ”€â”€ config/
â”‚ â”œâ”€â”€ ramp_template.xlsx 
â”‚ â”œâ”€â”€ path_manager.py # 
â”‚ â””â”€â”€ assets/ # Logo and UI images
â”‚
â”œâ”€â”€ core/
â”‚ â”œâ”€â”€ utils.py # Helper utilities
â”‚ â””â”€â”€ ramp_core.py # Orchestration of RAMP execution
â”‚
â”œâ”€â”€ inputs/
â”‚ â”œâ”€â”€ archetypes/ # Generated archetype Excel files
â”‚ â”œâ”€â”€ year_structure.yaml # Saved configuration
â”‚ â””â”€â”€ ramp_input.xlsx # Full single-archetype input
â”‚
â”œâ”€â”€ outputs/
â”‚ â”œâ”€â”€ profile_*.csv # Per-category final daily profiles
â”‚ â””â”€â”€ profile_aggregated.csv # Final aggregated (365Ã—1440)
â”‚
â”œâ”€â”€ requirements.txt
â””â”€â”€ environment.yaml

```

---

# **Inputs**

### **RAMP Input Excel**
A structured spreadsheet containing:
- Category name  
- Appliance attributes  
- Usage windows and probabilities  
- Stochastic behaviour parameters  

A ready-to-use example can be found in:  
**examples/RAMP Excel Inputs Example.xlsx**

### **Year Structure Configuration**
Automatically saved to:
**inputs/year_structure.yaml**

### **Archetype Metadata**
Automatically saved to:
**inputs/archetype_configs.json**

---

# **Outputs**

Outputs are produced in **CSV format** for readability and compatibility.

### **Per user category**
`profile_<category>.csv`  
Shape: **365 Ã— 1440** (days Ã— minutes)

### **Aggregated daily demand**
`profile_aggregated.csv`  
Shape: **365 Ã— 1440**

### **Optional hourly file**
`profile_aggregated_hourly.csv`  
Shape: **365 Ã— 24**

These files can be directly used in MicroGridsPy and other energy modelling frameworks.

# **âš™ Installation**

## **A) Using pip + requirements.txt**

```bash
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

## **B) Using Conda + environment.yaml**
```bash
conda env create -f environment.yaml
conda activate ramp_app
```

---

# **ğŸš€ Running the Streamlit App**
From the project root:
```bash
streamlit run app.py
```
The app will open automatically in the browser, or you can visit:
```bash
http://localhost:8501
```

# ğŸ‘¥ Contacts"

**Alessandro Onori**  
ğŸ“§ [alessandro.onori@polimi.it](mailto:{alessandro.onori@polimi.it})  
ğŸ› ï¸ *Core backend model, modeling advancements, and Streamlit UI development*  

Technical Advisors
- Riccardo Mereu, Politecnico di Milano  
- Emanuela Colombo, Politecnico di Milano


## License
This is a free software licensed under the â€œEuropean Union Public Licence" EUPL v1.1. It can be redistributed and/or modified under the terms of this license.